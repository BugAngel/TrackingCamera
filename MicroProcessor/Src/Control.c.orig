/**
  ******************************************************************************
  * @file    control.h
  * @author  WangRong
  * @version V1.0
  * @date    2016/1/13
  * @brief   control

  ******************************************************************************
  */
#include "stm32f1xx_hal.h"
#include "pid.h"
#include "Control.h"
#include "Motor.h"

/**
  * @brief  PID控制
  * @param  line_pos:当前位置信息
  * @retval NONE
  */
  
  PidTypeDef AboveSteerPID;
  PidTypeDef BelowSteerPID;
  
  void PID_init(void)
{
      PID_SetParam(&AboveSteerPID, 17, 1, 15, 0, 0, 0, 0);  //舵机PID
	  PID_SetParam(&BelowSteerPID, 17, 1, 15, 0, 0, 0, 0);  //舵机PID
}

void Pid_Control(uint8_t line_pos)
{
    PID_PositionCalc(&AboveSteerPID, line_pos, 63);
    BelowSteerChange(-AboveSteerPID.U);                           //舵机转向控制
	
	PID_PositionCalc(&BelowSteerPID, line_pos, 63);
    AboveSteerChange(-BelowSteerPID.U);                           //舵机转向控制

//    PID_PositionCalc(&PositionPID, line_pos, 63);

//    MotorSpeedL((int32_t)( SPEEDBASE + PositionPID.U));  //电机转速控制
//    MotorSpeedR((int32_t)( SPEEDBASE - PositionPID.U));  //加减号方向控制转向
}



